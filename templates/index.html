{% extends "base.html" %}

{% block content %}
<div class="row mb-4">
    <div class="col-md-8">
        <div class="btn-group" role="group" aria-label="代理操作">
            <button type="button" class="btn btn-success" id="startFetchBtn">获取代理</button>
            <button type="button" class="btn btn-primary" id="importProxiesBtn" disabled>导入代理</button>
            <button type="button" class="btn btn-warning" id="cancelTaskBtn" disabled>取消任务</button>
            <button type="button" class="btn btn-danger" id="clearProxiesBtn">清空列表</button>
            <button type="button" class="btn btn-outline-info" id="retestAllBtn" disabled>全部重测</button>
            <button type="button" class="btn btn-primary" id="exportProxiesBtn" disabled>导出代理</button>
        </div>
    </div>
    <div class="col-md-4">
        <div class="input-group">
            <span class="input-group-text">当前代理</span>
            <input type="text" class="form-control" id="currentProxyInput" value="N/A" readonly>
            <button class="btn btn-outline-secondary" type="button" id="copyCurrentProxyBtn">复制</button>
        </div>
    </div>
</div>

<div class="row mb-4">
    <div class="col-md-6">
        <div class="input-group">
            <label class="input-group-text" for="regionFilter">地区</label>
            <select class="form-select" id="regionFilter">
                <option value="">全部国家</option>
                <option value="CN">中国</option>
                <option value="US">美国</option>
                <!-- 可以动态加载 -->
            </select>
            <div class="input-group-text">
                <input class="form-check-input mt-0" type="checkbox" id="qualityFilterCheck">
                <label class="form-check-label ms-2" for="qualityFilterCheck">优质</label>
            </div>
            <input type="number" class="form-control" id="qualityLatencyInput" placeholder="ms <" min="0" value="2000" style="max-width: 80px;">
            <button class="btn btn-outline-secondary" type="button" id="rotateProxyBtn" disabled>轮换IP</button>
            <div class="input-group-text">
                <input class="form-check-input mt-0" type="checkbox" id="autoRotateCheck" disabled>
                <label class="form-check-label ms-2" for="autoRotateCheck">自动</label>
            </div>
            <input type="number" class="form-control" id="autoRotateInterval" placeholder="秒" min="0" value="10" style="max-width: 60px;">
        </div>
    </div>
    <div class="col-md-6">
        <div class="btn-group" role="group" aria-label="服务控制">
            <button type="button" class="btn btn-info" id="toggleServerBtn" disabled>启动服务</button>
            <span class="align-self-center ms-2">SOCKS5:1800 / HTTP:1801</span>
        </div>
    </div>
</div>

<div class="row mb-3">
    <div class="col-12">
        <div class="progress" style="height: 20px;">
            <div id="progressBar" class="progress-bar progress-bar-striped bg-success" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
        </div>
    </div>
</div>

<div class="row flex-grow-1">
    <div class="col-md-8 d-flex flex-column">
        <div class="card flex-grow-1 mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <span>可用代理列表</span>
                <span id="proxyCountBadge" class="badge bg-secondary">0</span>
            </div>
            <div class="card-body p-0" style="overflow-y: auto; max-height: 400px;">
                <table class="table table-striped table-hover mb-0" id="proxyTable">
                    <thead>
                        <tr>
                            <th scope="col" data-sort="score">分数</th>
                            <th scope="col" data-sort="anonymity">匿名度</th>
                            <th scope="col" data-sort="protocol">协议</th>
                            <th scope="col" data-sort="proxy">代理地址</th>
                            <th scope="col" data-sort="delay">延迟(ms)</th>
                            <th scope="col" data-sort="speed">速度(Mbps)</th>
                            <th scope="col" data-sort="region">国家/地区</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- 代理数据将通过 AJAX 动态填充 -->
                        <tr id="noDataPlaceholder">
                            <td colspan="7" class="text-center">暂无代理数据</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="col-md-4 d-flex flex-column">
        <div class="card flex-grow-1">
            <div class="card-header">实时日志</div>
            <div class="card-body p-0" style="overflow-y: auto; max-height: 400px;">
                <pre id="logArea" class="p-3 mb-0" style="background-color: #2a2a2a; color: #cccccc; height: 100%; margin: 0; white-space: pre-wrap; word-wrap: break-word;"></pre>
            </div>
        </div>
    </div>
</div>

{% endblock %}
